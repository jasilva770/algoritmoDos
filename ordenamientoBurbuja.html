<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Algoritmo de Ordenamiento por Burbuja - Simulador Interactivo</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f8f9fa;
        }
        
        h2, h3 {
            color: #2c3e50;
        }
        
        h2 {
            border-bottom: 2px solid #e74c3c;
            padding-bottom: 10px;
            margin-top: 30px;
        }
        
        .example-container {
            margin: 2rem 0;
        }

        .code-and-array {
            display: flex;
            gap: 2rem;
            align-items: flex-start;
            flex-wrap: wrap;
        }

        .code-box, .array-box {
            flex: 1;
            min-width: 340px;
            box-sizing: border-box;
        }

        .code-box pre {
            background: #1e1e1e;
            color: #dcdcdc;
            padding: 1.5rem;
            border-radius: 12px;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            line-height: 1.6;
            white-space: pre-wrap;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .code-line {
            display: block;
            padding: 3px 0;
            transition: all 0.3s ease;
            position: relative;
        }

        .code-line.highlight {
            background-color: #ffeb3b;
            color: #000;
            border-left: 5px solid #ffc107;
            padding-left: 15px;
            margin-left: -15px;
            font-weight: bold;
            box-shadow: 0 0 10px rgba(255,235,59,0.5);
        }

        .array-box {
            background: #f5f5f5;
            padding: 1.5rem;
            border-radius: 12px;
            border: 2px solid #e0e0e0;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .array-box h3 {
            margin-top: 0;
        }

        .array-container {
            display: flex;
            justify-content: center;
            margin: 2rem 0;
            flex-wrap: wrap;
            gap: 5px;
        }

        .array-element {
            width: 50px;
            height: 50px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background: #e74c3c;
            color: white;
            margin: 3px;
            border-radius: 8px;
            font-weight: bold;
            font-size: 1.2rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
            transition: all 0.3s ease;
            position: relative;
        }

        .array-index {
            font-size: 0.8rem;
            opacity: 0.9;
            position: absolute;
            top: -20px;
            background: #c0392b;
            padding: 2px 6px;
            border-radius: 4px;
        }

        .array-element.compare {
            background: #f39c12;
            transform: scale(1.1);
            box-shadow: 0 0 15px rgba(243, 156, 18, 0.7);
        }

        .array-element.swap {
            background: #2ecc71;
            transform: scale(1.15);
            box-shadow: 0 0 15px rgba(46, 204, 113, 0.7);
        }

        .array-element.sorted {
            background: #27ae60;
            box-shadow: 0 0 15px rgba(39, 174, 96, 0.7);
            transform: scale(1.05);
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        .simulation-box {
            background: linear-gradient(135deg, #fdeaea, #f7c6cb);
            padding: 1.8rem;
            border-radius: 12px;
            margin: 2rem 0;
            box-shadow: 0 6px 12px rgba(231, 76, 54, 0.2);
        }

        .simulation-controls {
            margin: 1.5rem 0;
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            align-items: center;
        }

        .btn {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 0.6rem 1.2rem;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn:hover:not(:disabled) {
            background: #c0392b;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .btn:disabled {
            background: #bdbdbd;
            cursor: not-allowed;
            transform: none;
        }

        #input-buscar {
            padding: 0.6rem;
            font-size: 1.1rem;
            border: 2px solid #e74c3c;
            border-radius: 8px;
            width: 140px;
            font-weight: bold;
            text-align: center;
        }

        #input-buscar:focus {
            outline: none;
            border-color: #c0392b;
            box-shadow: 0 0 0 3px rgba(231, 76, 54, 0.3);
        }

        .paso-bar {
            width: 100%;
            height: 8px;
            background: #e0e0e0;
            border-radius: 4px;
            margin-top: 1rem;
            overflow: hidden;
        }

        #paso-progress {
            height: 100%;
            background: linear-gradient(90deg, #27ae60, #e74c3c);
            width: 0%;
            transition: width 0.5s ease;
        }

        .result-box {
            background: white;
            padding: 1rem;
            border-radius: 8px;
            border-left: 4px solid #e74c3c;
            margin: 1rem 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .legend {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin: 1rem 0;
            flex-wrap: wrap;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9rem;
        }

        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 4px;
        }

        .step-explanation {
            background: #e8f5e9;
            padding: 1rem;
            border-radius: 8px;
            margin: 1rem 0;
            border-left: 4px solid #4CAF50;
            font-weight: bold;
        }

        @media (max-width: 768px) {
            .code-and-array {
                flex-direction: column;
            }
            .array-box {
                margin-top: 1.5rem;
            }
            .simulation-controls {
                justify-content: center;
            }
            .array-element {
                width: 40px;
                height: 40px;
                font-size: 1rem;
                margin: 2px;
            }
            .array-container {
                justify-content: flex-start;
            }
        }
    </style>
</head>
<body>

    <section>
        <h3>üìå ¬øQu√© es?</h3>
        <p>El <strong>ordenamiento por burbuja</strong> es un algoritmo simple que ordena un array comparando pares adyacentes y los intercambia si est√°n en el orden incorrecto.</p>
        
        <h3>üåç Analog√≠a del mundo real</h3>
        <p>Es como ordenar una fila de personas de m√°s bajo a m√°s alto: <em>‚ÄúCompara a cada persona con la siguiente, y si la primera es m√°s alta, las cambias de lugar. Repites esto varias veces hasta que nadie tenga que moverse.‚Äù</em></p>

        <h3>‚úÖ Ventajas</h3>
        <ul>
            <li>F√°cil de entender e implementar.</li>
            <li>No requiere espacio extra (ordena in-place).</li>
            <li>Ideal para explicar conceptos b√°sicos de algoritmos.</li>
        </ul>

        <h3>‚ùå Desventajas</h3>
        <ul>
            <li>Ineficiente para grandes conjuntos de datos: O(n¬≤).</li>
            <li>No es estable (puede cambiar el orden relativo de elementos iguales).</li>
            <li>No es √≥ptimo en la pr√°ctica, pero excelente para aprendizaje.</li>
        </ul>
    </section>
    <h2>üîπ Algoritmo de Ordenamiento por Burbuja</h2>

    <section class="simulation-box">
        <h3>‚ñ∂Ô∏è Simulaci√≥n Interactiva - Paso a Paso</h3>
        <p>Modifica el tama√±o del array o genera uno nuevo, luego usa los botones para avanzar o retroceder en la ejecuci√≥n.</p>
        
        <div class="simulation-controls">
            <button id="btn-generar" class="btn">üîÑ Generar Nuevo Array</button>
            <button id="btn-reiniciar" class="btn">üîÅ Reiniciar</button>
            <button id="btn-anterior" class="btn" disabled>‚¨ÖÔ∏è Anterior</button>
            <button id="btn-siguiente" class="btn">Siguiente ‚û°Ô∏è</button>
        </div>

        <div class="legend">
            <div class="legend-item">
                <div class="legend-color" style="background: #e74c3c; border-color: white;"></div>
                <span>Elemento normal</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #f39c12; border-color: white;"></div>
                <span>Comparando (Naranja)</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #2ecc71; border-color: white;"></div>
                <span>Intercambiando (Verde)</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #27ae60; border-color: white;"></div>
                <span>Ordenado (Verde oscuro)</span>
            </div>
        </div>

        <div id="output-simulacion">
            <div id="step-explanation" class="step-explanation">
                ¬°Bienvenido a la simulaci√≥n interactiva del Ordenamiento por Burbuja!<br><br>
                Presiona "Siguiente" para ver c√≥mo funciona este algoritmo paso a paso.
            </div>
            <p><strong>Paso actual:</strong> <span id="paso">Esperando inicio...</span></p>
            <div id="paso-indicator" class="paso-bar">
                <div id="paso-progress"></div>
            </div>
            <div id="result-box" class="result-box">
                <p id="result-message">El ordenamiento a√∫n no ha comenzado.</p>
            </div>
        </div>
    </section>

<section class="example-container">
        <div class="code-and-array">
            <!-- C√≥digo Java -->
            <div class="code-box">
                <h3>üíª Ejemplo Completo: Ordenamiento por Burbuja en Java</h3>
                <pre><code><span class="code-line" data-line="1">public class BubbleSort {</span>
<span class="code-line" data-line="2">    </span>
<span class="code-line" data-line="3">    // M√©todo principal de ordenamiento por burbuja</span>
<span class="code-line highlightable" data-line="4" id="line-main-method">    public static void bubbleSort(int[] arr) {</span>
<span class="code-line highlightable" data-line="5" id="line-outer-loop">        int n = arr.length;</span>
<span class="code-line highlightable" data-line="6" id="line-outer-loop-start">        for (int i = 0; i < n - 1; i++) {</span>
<span class="code-line highlightable" data-line="7" id="line-inner-loop">            boolean swapped = false;</span>
<span class="code-line highlightable" data-line="8" id="line-inner-loop-start">            for (int j = 0; j < n - i - 1; j++) {</span>
<span class="code-line highlightable" data-line="9" id="line-compare">                if (arr[j] > arr[j + 1]) {</span>
<span class="code-line highlightable" data-line="10" id="line-swap">                    // Intercambiar elementos</span>
<span class="code-line highlightable" data-line="11" id="line-swap-code">                    int temp = arr[j];</span>
<span class="code-line highlightable" data-line="12" id="line-swap-code2">                    arr[j] = arr[j + 1];</span>
<span class="code-line highlightable" data-line="13" id="line-swap-code3">                    arr[j + 1] = temp;</span>
<span class="code-line highlightable" data-line="14" id="line-swapped">                    swapped = true;</span>
<span class="code-line" data-line="15">                }</span>
<span class="code-line" data-line="16">            }</span>
<span class="code-line highlightable" data-line="17" id="line-optimization">            if (!swapped) break;  // Si no hubo intercambios, el array ya est√° ordenado</span>
<span class="code-line" data-line="18">        }</span>
<span class="code-line" data-line="19">    }</span>
<span class="code-line" data-line="20">    </span>
<span class="code-line" data-line="21">    // M√©todo main para probar el algoritmo</span>
<span class="code-line" data-line="22">    public static void main(String[] args) {</span>
<span class="code-line" data-line="23">        int[] numeros = {64, 34, 25, 12, 22, 11, 90};</span>
<span class="code-line" data-line="24">        System.out.println("Array original: " + java.util.Arrays.toString(numeros));</span>
<span class="code-line" data-line="25">        bubbleSort(numeros);</span>
<span class="code-line" data-line="26">        System.out.println("Array ordenado: " + java.util.Arrays.toString(numeros));</span>
<span class="code-line" data-line="27">    }</span>
<span class="code-line" data-line="28">}</span></code></pre>
            </div>

            <!-- Representaci√≥n del Array -->
            <div class="array-box">
                <h3>üìä Representaci√≥n Visual del Array</h3>
                <div class="array-container" id="array-visual">
                    <!-- Los elementos del array se generar√°n din√°micamente -->
                </div>
                <p><strong>Tama√±o del array:</strong> <span id="array-size">7</span></p>
            </div>
        </div>
    </section>

    <script>
    class BubbleSortSimulator {
        constructor() {
            this.currentStep = 0;
            this.array = [];
            this.originalArray = [];
            this.size = 7;
            this.i = 0; // Iteraci√≥n externa (pasadas completas)
            this.j = 0; // √çndice de comparaci√≥n actual
            this.swapped = false;
            this.stepsHistory = []; // Guarda estado en CADA comparaci√≥n
            this.currentLine = null;
            this.isRunning = false;

            this.initializeElements();
            this.bindEvents();
            this.generarArray();
            this.reiniciar();
        }

        initializeElements() {
            // Controles
            this.btnGenerar = document.getElementById('btn-generar');
            this.btnReiniciar = document.getElementById('btn-reiniciar');
            this.btnAnterior = document.getElementById('btn-anterior');
            this.btnSiguiente = document.getElementById('btn-siguiente');
            this.stepExplanation = document.getElementById('step-explanation');

            // Salida
            this.pasoEl = document.getElementById('paso');
            this.pasoProgress = document.getElementById('paso-progress');
            this.resultBox = document.getElementById('result-box');
            this.resultMessage = document.getElementById('result-message');
            this.arraySizeEl = document.getElementById('array-size');

            // L√≠neas de c√≥digo
            this.codeLines = {};
            const lineIds = [
                'line-main-method', 'line-outer-loop', 'line-outer-loop-start',
                'line-inner-loop', 'line-inner-loop-start', 'line-compare',
                'line-swap', 'line-swap-code', 'line-swap-code2', 'line-swap-code3',
                'line-swapped', 'line-optimization'
            ];
            
            lineIds.forEach(id => {
                this.codeLines[id] = document.getElementById(id);
            });

            // Array visual
            this.arrayVisual = document.getElementById('array-visual');
        }

        bindEvents() {
            this.btnGenerar.addEventListener('click', () => this.generarArray());
            this.btnReiniciar.addEventListener('click', () => this.reiniciar());
            this.btnAnterior.addEventListener('click', () => this.pasoAnterior());
            this.btnSiguiente.addEventListener('click', () => this.siguientePaso());
        }

        generarArray() {
            this.array = [];
            for (let i = 0; i < this.size; i++) {
                this.array.push(Math.floor(Math.random() * 50) + 1);
            }
            this.originalArray = [...this.array];
            this.actualizarVisualizacionArray();
            this.reiniciar();
        }

        actualizarVisualizacionArray() {
            this.arrayVisual.innerHTML = '';
            for (let i = 0; i < this.array.length; i++) {
                const elemento = document.createElement('div');
                elemento.className = 'array-element';
                elemento.id = `element-${i}`;
                elemento.innerHTML = `
                    <div class="array-index">${i}</div>
                    ${this.array[i]}
                `;
                this.arrayVisual.appendChild(elemento);
            }
            this.arraySizeEl.textContent = this.array.length;
        }

        reiniciar() {
            this.currentStep = 0;
            this.i = 0;
            this.j = 0;
            this.swapped = false;
            this.stepsHistory = [];
            this.isRunning = false;

            this.resetAll();
            this.stepExplanation.innerHTML = "¬°Bienvenido a la simulaci√≥n interactiva del Ordenamiento por Burbuja!<br><br>Presiona \"Siguiente\" para ver c√≥mo cada elemento burbujea hacia su posici√≥n correcta.";
            this.pasoEl.textContent = "Estado inicial. Presiona 'Siguiente' para comenzar.";
            this.resultMessage.textContent = "El ordenamiento a√∫n no ha comenzado.";
            this.resultBox.className = "result-box";
            this.updateUI();
        }

        resetAll() {
            document.querySelectorAll('.code-line.highlight').forEach(el => el.classList.remove('highlight'));
            for (let i = 0; i < this.array.length; i++) {
                const el = document.getElementById(`element-${i}`);
                if (el) el.className = 'array-element';
            }
        }

        actualizarIndicadoresArray() {
            // Reset
            for (let i = 0; i < this.array.length; i++) {
                const el = document.getElementById(`element-${i}`);
                if (el) el.classList.remove('compare', 'swap', 'sorted');
            }

            // Comparando
            if (this.j < this.array.length - 1) {
                const e1 = document.getElementById(`element-${this.j}`);
                const e2 = document.getElementById(`element-${this.j + 1}`);
                if (e1) e1.classList.add('compare');
                if (e2) e2.classList.add('compare');
            }

            // Ordenados (√∫ltimos i elementos)
            for (let k = this.array.length - this.i; k < this.array.length; k++) {
                if (k >= 0) {
                    const el = document.getElementById(`element-${k}`);
                    if (el) el.classList.add('sorted');
                }
            }
        }

        guardarEstadoActual() {
            const estado = {
                array: [...this.array],
                i: this.i,
                j: this.j,
                swapped: this.swapped,
                currentLine: this.currentLine
            };
            this.stepsHistory[this.currentStep] = {...estado};
        }

        restaurarEstadoAnterior() {
            if (this.currentStep < this.stepsHistory.length && this.stepsHistory[this.currentStep]) {
                const estado = this.stepsHistory[this.currentStep];
                this.array = [...estado.array];
                this.i = estado.i;
                this.j = estado.j;
                this.swapped = estado.swapped;
                this.currentLine = estado.currentLine;

                this.resetAll();
                if (this.currentLine && this.codeLines[this.currentLine]) {
                    this.codeLines[this.currentLine].classList.add('highlight');
                }

                this.actualizarVisualizacionArray();
                this.actualizarIndicadoresArray();
            }
        }

        async resaltarLinea(lineId, mensaje) {
            this.resetAll();
            if (lineId && this.codeLines[lineId]) {
                this.codeLines[lineId].classList.add('highlight');
                this.currentLine = lineId;
            }
            this.pasoEl.textContent = mensaje;
            this.actualizarVisualizacionArray();
            this.actualizarIndicadoresArray();
            await this.sleep(600);
        }

        async siguientePaso() {
            if (this.isRunning) return;
            this.isRunning = true;

            this.guardarEstadoActual();
            this.currentStep++;

            // Si es el primer paso, iniciar
            if (this.currentStep === 1) {
                await this.resaltarLinea('line-main-method', "Iniciando el m√©todo bubbleSort");
                await this.resaltarLinea('line-outer-loop', "n = tama√±o del array");
            }

            // Ejecutar hasta completar una comparaci√≥n o terminar
            while (this.i < this.array.length - 1) {
                // Si es el inicio de una pasada externa
                if (this.j === 0) {
                    await this.resaltarLinea('line-outer-loop-start', `üî∑ Pasada externa ${this.i + 1}`);
                    await this.resaltarLinea('line-inner-loop', "swapped = false (reiniciamos para esta pasada)");
                    this.swapped = false;
                }

                // Verificar si ya terminamos esta pasada interna
                if (this.j >= this.array.length - this.i - 1) {
                    await this.resaltarLinea('line-optimization', this.swapped ? 
                        "Hubo intercambios ‚Üí seguimos con la siguiente pasada." : 
                        "‚úÖ ¬°No hubo intercambios! El array ya est√° ordenado.");

                    if (!this.swapped) {
                        this.terminarSimulacion("optimizaci√≥n");
                        this.isRunning = false;
                        return;
                    }

                    this.j = 0;
                    this.i++;
                    continue; // Reiniciar el bucle para la siguiente pasada
                }

                // --- COMPARAR ---
                await this.resaltarLinea('line-compare', `¬ø${this.array[this.j]} > ${this.array[this.j + 1]}?`);

                if (this.array[this.j] > this.array[this.j + 1]) {
                    // --- INTERCAMBIAR ---
                    await this.resaltarLinea('line-swap', "¬°S√≠! Intercambiamos.");
                    await this.resaltarLinea('line-swap-code', `temp = ${this.array[this.j]}`);

                    const temp = this.array[this.j];
                    await this.resaltarLinea('line-swap-code2', `arr[${this.j}] = arr[${this.j + 1}] = ${this.array[this.j + 1]}`);
                    this.array[this.j] = this.array[this.j + 1];
                    this.actualizarVisualizacionArray();
                    this.actualizarIndicadoresArray();
                    await this.sleep(400);

                    await this.resaltarLinea('line-swap-code3', `arr[${this.j + 1}] = temp = ${temp}`);
                    this.array[this.j + 1] = temp;
                    this.actualizarVisualizacionArray();
                    this.actualizarIndicadoresArray();
                    await this.sleep(400);

                    await this.resaltarLinea('line-swapped', "swapped = true (marcamos que hubo cambio)");
                    this.swapped = true;
                } else {
                    await this.resaltarLinea(null, `‚úÖ ${this.array[this.j]} <= ${this.array[this.j + 1]}, no se intercambia.`);
                }

                // Avanzar al siguiente par
                this.j++;
                this.isRunning = false;
                this.updateUI();
                return; // ¬°ESTE ES EL CAMBIO CLAVE! Salimos despu√©s de CADA comparaci√≥n.
            }

            // Si llegamos aqu√≠, termin√≥ el algoritmo normalmente
            this.terminarSimulacion("completado");
            this.isRunning = false;
        }

        async pasoAnterior() {
            if (this.currentStep > 0) {
                this.currentStep--;
                this.restaurarEstadoAnterior();
                this.updateUI();
            }
        }

        terminarSimulacion(modo) {
            this.resetAll();
            this.stepExplanation.innerHTML = modo === "optimizaci√≥n" 
                ? "‚úÖ ¬°Simulaci√≥n terminada por optimizaci√≥n!<br><br>Ning√∫n intercambio ocurri√≥ en una pasada completa ‚Üí el array ya estaba ordenado."
                : "‚úÖ ¬°Simulaci√≥n completada!<br><br>Se realizaron todas las pasadas. El array est√° ordenado.";
            this.pasoEl.textContent = "Simulaci√≥n finalizada.";
            this.resultMessage.textContent = "El array ha sido ordenado correctamente.";
            this.resultBox.className = "result-box";
            this.btnSiguiente.disabled = true;
            this.updateUI();
        }

        sleep(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }

        updateUI() {
            this.btnAnterior.disabled = this.currentStep <= 0;
            this.btnSiguiente.disabled = this.i >= this.array.length - 1 && this.j >= this.array.length - this.i - 1;

            // Progreso: total de comparaciones posibles
            let total = 0;
            for (let x = 0; x < this.array.length - 1; x++) {
                total += (this.array.length - 1 - x);
            }
            let current = 0;
            for (let x = 0; x < this.i; x++) {
                current += (this.array.length - 1 - x);
            }
            current += this.j;

            let progress = total > 0 ? (current / total) * 100 : 0;
            this.pasoProgress.style.width = `${Math.min(progress, 100)}%`;
        }
    }

    document.addEventListener('DOMContentLoaded', function() {
        new BubbleSortSimulator();
    });
</script>
</body>
</html>