<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ordenamiento por Inserci√≥n - Simulador Interactivo</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f8f9fa;
        }

        h1, h2, h3 {
            color: #2c3e50;
        }

        h1 {
            text-align: center;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
            margin-top: 30px;
        }

        h2 {
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
            margin-top: 30px;
        }

        .section {
            margin: 2rem 0;
            padding: 1.5rem;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .code-and-array {
            display: flex;
            gap: 2rem;
            align-items: flex-start;
            flex-wrap: wrap;
        }

        .code-box, .array-box {
            flex: 1;
            min-width: 340px;
            box-sizing: border-box;
        }

        .code-box pre {
            background: #1e1e1e;
            color: #dcdcdc;
            padding: 1.5rem;
            border-radius: 12px;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            line-height: 1.6;
            white-space: pre-wrap;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .code-line {
            display: block;
            padding: 3px 0;
            transition: all 0.3s ease;
            position: relative;
        }

        .code-line.highlight {
            background-color: #ffeb3b;
            color: #000;
            border-left: 5px solid #ffc107;
            padding-left: 15px;
            margin-left: -15px;
            font-weight: bold;
            box-shadow: 0 0 10px rgba(255,235,59,0.5);
        }

        .array-box {
            background: #f5f5f5;
            padding: 1.5rem;
            border-radius: 12px;
            border: 2px solid #e0e0e0;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .array-box h3 {
            margin-top: 0;
        }

        .array-container {
            display: flex;
            justify-content: center;
            margin: 2rem 0;
            flex-wrap: wrap;
            gap: 5px;
        }

        .array-element {
            width: 50px;
            height: 50px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background: #3498db;
            color: white;
            margin: 3px;
            border-radius: 8px;
            font-weight: bold;
            font-size: 1.2rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
            transition: all 0.3s ease;
            position: relative;
        }

        .array-index {
            font-size: 0.8rem;
            opacity: 0.9;
            position: absolute;
            top: -20px;
            background: #2980b9;
            padding: 2px 6px;
            border-radius: 4px;
        }

        .array-element.compare {
            background: #e74c3c;
            transform: scale(1.1);
            box-shadow: 0 0 15px rgba(231, 76, 54, 0.7);
        }

        .array-element.inserting {
            background: #f39c12;
            transform: scale(1.15);
            box-shadow: 0 0 15px rgba(243, 156, 18, 0.7);
        }

        .array-element.sorted {
            background: #27ae60;
            box-shadow: 0 0 15px rgba(39, 174, 96, 0.7);
            transform: scale(1.05);
        }

        .simulation-box {
            background: linear-gradient(135deg, #e3f2fd, #bbdefb);
            padding: 1.8rem;
            border-radius: 12px;
            margin: 2rem 0;
            box-shadow: 0 6px 12px rgba(52, 152, 219, 0.2);
        }

        .simulation-controls {
            margin: 1.5rem 0;
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            align-items: center;
        }

        .btn {
            background: #3498db;
            color: white;
            border: none;
            padding: 0.6rem 1.2rem;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn:hover:not(:disabled) {
            background: #2980b9;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .btn:disabled {
            background: #bdbdbd;
            cursor: not-allowed;
            transform: none;
        }

        .paso-bar {
            width: 100%;
            height: 8px;
            background: #e0e0e0;
            border-radius: 4px;
            margin-top: 1rem;
            overflow: hidden;
        }

        #paso-progress {
            height: 100%;
            background: linear-gradient(90deg, #27ae60, #3498db);
            width: 0%;
            transition: width 0.5s ease;
        }

        .result-box {
            background: white;
            padding: 1rem;
            border-radius: 8px;
            border-left: 4px solid #3498db;
            margin: 1rem 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .legend {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin: 1rem 0;
            flex-wrap: wrap;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9rem;
        }

        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 4px;
        }

        .step-explanation {
            background: #e8f5e9;
            padding: 1rem;
            border-radius: 8px;
            margin: 1rem 0;
            border-left: 4px solid #4CAF50;
            font-weight: bold;
        }

        @media (max-width: 768px) {
            .code-and-array {
                flex-direction: column;
            }
            .array-box {
                margin-top: 1.5rem;
            }
            .simulation-controls {
                justify-content: center;
            }
            .array-element {
                width: 40px;
                height: 40px;
                font-size: 1rem;
                margin: 2px;
            }
            .array-container {
                justify-content: flex-start;
            }
        }
    </style>
</head>
<body>

    <!-- Encabezado -->
    <h1><strong>üìö Ordenamiento por Inserci√≥n</strong></h1>

    <!-- Secci√≥n: ¬øQu√© es? -->
    <section class="section">
        <h2>üìå ¬øQu√© es?</h2>
        <p>El <strong>ordenamiento por inserci√≥n</strong> es un algoritmo simple que construye un array ordenado uno a uno, tomando cada elemento y coloc√°ndolo en la posici√≥n correcta dentro de la parte ya ordenada.</p>
        
        <h3>üåç Analog√≠a del mundo real</h3>
        <p>Es como ordenar cartas en una mano: <em>‚ÄúTienes algunas cartas ordenadas. Tomas la siguiente carta y la colocas en su lugar correcto entre las ya ordenadas.‚Äù</em></p>
    </section>

    <!-- Secci√≥n: Ventajas y Desventajas -->
    <section class="section">
        <h2>‚úÖ Ventajas</h2>
        <ul>
            <li>F√°cil de entender e implementar.</li>
            <li>Eficiente para arrays peque√±os o casi ordenados.</li>
            <li>Estable: no cambia el orden relativo de elementos iguales.</li>
            <li>Ordena in-place (no necesita espacio extra).</li>
        </ul>

        <h2>‚ùå Desventajas</h2>
        <ul>
            <li>Ineficiente para grandes conjuntos: O(n¬≤).</li>
            <li>No es √≥ptimo para datos aleatorios grandes.</li>
        </ul>
    </section>

    <!-- Secci√≥n: Simulaci√≥n -->
    <section class="simulation-box">
        <h2>‚ñ∂Ô∏è Simulaci√≥n Interactiva - Paso a Paso</h2>
        <p>Modifica el tama√±o del array o genera uno nuevo, luego usa los botones para avanzar o retroceder en la ejecuci√≥n.</p>
        
        <div class="simulation-controls">
            <button id="btn-generar" class="btn">üîÑ Generar Nuevo Array</button>
            <button id="btn-reiniciar" class="btn">üîÅ Reiniciar</button>
            <button id="btn-anterior" class="btn" disabled>‚¨ÖÔ∏è Anterior</button>
            <button id="btn-siguiente" class="btn">Siguiente ‚û°Ô∏è</button>
        </div>

        <div class="legend">
            <div class="legend-item">
                <div class="legend-color" style="background: #3498db; border-color: white;"></div>
                <span>Elemento normal</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #e74c3c; border-color: white;"></div>
                <span>Comparando (Rojo)</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #f39c12; border-color: white;"></div>
                <span>Insertando (Naranja)</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #27ae60; border-color: white;"></div>
                <span>Ordenado (Verde)</span>
            </div>
        </div>

        <div id="output-simulacion">
            <div id="step-explanation" class="step-explanation">
                ¬°Bienvenido a la simulaci√≥n interactiva del Ordenamiento por Inserci√≥n!<br><br>
                Presiona "Siguiente" para ver c√≥mo se inserta cada elemento en su posici√≥n correcta.
            </div>
            <p><strong>Paso actual:</strong> <span id="paso">Esperando inicio...</span></p>
            <div id="paso-indicator" class="paso-bar">
                <div id="paso-progress"></div>
            </div>
            <div id="result-box" class="result-box">
                <p id="result-message">El ordenamiento a√∫n no ha comenzado.</p>
            </div>
        </div>
    </section>

    <!-- Secci√≥n: C√≥digo y Visualizaci√≥n -->
    <section class="example-container">
        <div class="code-and-array">
            <!-- C√≥digo Java -->
            <div class="code-box">
                <h3>üíª Ejemplo Completo: Ordenamiento por Inserci√≥n en Java</h3>
                <pre><code><span class="code-line" data-line="1">public class InsertionSort {</span>
<span class="code-line" data-line="2">    </span>
<span class="code-line" data-line="3">    // M√©todo principal de ordenamiento por inserci√≥n</span>
<span class="code-line highlightable" data-line="4" id="line-main-method">    public static void insertionSort(int[] arr) {</span>
<span class="code-line highlightable" data-line="5" id="line-outer-loop">        for (int i = 1; i < arr.length; i++) {</span>
<span class="code-line highlightable" data-line="6" id="line-key">            int key = arr[i];</span>
<span class="code-line highlightable" data-line="7" id="line-j">            int j = i - 1;</span>
<span class="code-line highlightable" data-line="8" id="line-inner-loop-start">            while (j >= 0 && arr[j] > key) {</span>
<span class="code-line highlightable" data-line="9" id="line-shift">                arr[j + 1] = arr[j];</span>
<span class="code-line" data-line="10">                j--;</span>
<span class="code-line" data-line="11">            }</span>
<span class="code-line highlightable" data-line="12" id="line-insert">            arr[j + 1] = key;</span>
<span class="code-line" data-line="13">        }</span>
<span class="code-line" data-line="14">    }</span>
<span class="code-line" data-line="15">    </span>
<span class="code-line" data-line="16">    // M√©todo main para probar el algoritmo</span>
<span class="code-line" data-line="17">    public static void main(String[] args) {</span>
<span class="code-line" data-line="18">        int[] numeros = {64, 34, 25, 12, 22, 11, 90};</span>
<span class="code-line" data-line="19">        System.out.println("Array original: " + java.util.Arrays.toString(numeros));</span>
<span class="code-line" data-line="20">        insertionSort(numeros);</span>
<span class="code-line" data-line="21">        System.out.println("Array ordenado: " + java.util.Arrays.toString(numeros));</span>
<span class="code-line" data-line="22">    }</span>
<span class="code-line" data-line="23">}</span></code></pre>
            </div>

            <!-- Representaci√≥n del Array -->
            <div class="array-box">
                <h3>üìä Representaci√≥n Visual del Array</h3>
                <div class="array-container" id="array-visual">
                    <!-- Elementos se generar√°n din√°micamente -->
                </div>
                <p><strong>Tama√±o del array:</strong> <span id="array-size">7</span></p>
            </div>
        </div>
    </section>

    <!-- Script -->
    <script>
        class InsertionSortSimulator {
            constructor() {
                this.currentStep = 0;
                this.array = [];
                this.originalArray = [];
                this.size = 7;
                this.i = 1; // √çndice del bucle externo (elemento a insertar)
                this.j = 0; // √çndice para comparar hacia atr√°s
                this.key = 0;
                this.stepsHistory = [];
                this.currentLine = null;
                this.isRunning = false;

                this.initializeElements();
                this.bindEvents();
                this.generarArray();
                this.reiniciar();
            }

            initializeElements() {
                this.btnGenerar = document.getElementById('btn-generar');
                this.btnReiniciar = document.getElementById('btn-reiniciar');
                this.btnAnterior = document.getElementById('btn-anterior');
                this.btnSiguiente = document.getElementById('btn-siguiente');
                this.stepExplanation = document.getElementById('step-explanation');

                this.pasoEl = document.getElementById('paso');
                this.pasoProgress = document.getElementById('paso-progress');
                this.resultBox = document.getElementById('result-box');
                this.resultMessage = document.getElementById('result-message');
                this.arraySizeEl = document.getElementById('array-size');

                this.codeLines = {};
                const lineIds = [
                    'line-main-method', 'line-outer-loop', 'line-key', 'line-j',
                    'line-inner-loop-start', 'line-shift', 'line-insert'
                ];
                lineIds.forEach(id => {
                    this.codeLines[id] = document.getElementById(id);
                });

                this.arrayVisual = document.getElementById('array-visual');
            }

            bindEvents() {
                this.btnGenerar.addEventListener('click', () => this.generarArray());
                this.btnReiniciar.addEventListener('click', () => this.reiniciar());
                this.btnAnterior.addEventListener('click', () => this.pasoAnterior());
                this.btnSiguiente.addEventListener('click', () => this.siguientePaso());
            }

            generarArray() {
                this.array = [];
                for (let i = 0; i < this.size; i++) {
                    this.array.push(Math.floor(Math.random() * 50) + 1);
                }
                this.originalArray = [...this.array];
                this.actualizarVisualizacionArray();
                this.reiniciar();
            }

            actualizarVisualizacionArray() {
                this.arrayVisual.innerHTML = '';
                for (let i = 0; i < this.array.length; i++) {
                    const elemento = document.createElement('div');
                    elemento.className = 'array-element';
                    elemento.id = `element-${i}`;
                    elemento.innerHTML = `
                        <div class="array-index">${i}</div>
                        ${this.array[i]}
                    `;
                    this.arrayVisual.appendChild(elemento);
                }
                this.arraySizeEl.textContent = this.array.length;
            }

            reiniciar() {
                this.currentStep = 0;
                this.i = 1;
                this.j = 0;
                this.key = 0;
                this.stepsHistory = [];
                this.isRunning = false;

                this.resetAll();
                this.stepExplanation.innerHTML = "¬°Bienvenido a la simulaci√≥n interactiva del Ordenamiento por Inserci√≥n!<br><br>Presiona \"Siguiente\" para ver c√≥mo cada elemento se inserta en su posici√≥n correcta.";
                this.pasoEl.textContent = "Estado inicial. Presiona 'Siguiente' para comenzar.";
                this.resultMessage.textContent = "El ordenamiento a√∫n no ha comenzado.";
                this.resultBox.className = "result-box";
                this.updateUI();
            }

            resetAll() {
                document.querySelectorAll('.code-line.highlight').forEach(el => el.classList.remove('highlight'));
                for (let i = 0; i < this.array.length; i++) {
                    const el = document.getElementById(`element-${i}`);
                    if (el) el.className = 'array-element';
                }
            }

            actualizarIndicadoresArray() {
                for (let i = 0; i < this.array.length; i++) {
                    const el = document.getElementById(`element-${i}`);
                    if (el) el.classList.remove('compare', 'inserting', 'sorted');
                }

                // Marcar como insertando el elemento actual
                if (this.i < this.array.length) {
                    const el = document.getElementById(`element-${this.i}`);
                    if (el) el.classList.add('inserting');
                }

                // Comparando
                if (this.j >= 0 && this.j < this.array.length - 1) {
                    const el1 = document.getElementById(`element-${this.j}`);
                    const el2 = document.getElementById(`element-${this.j + 1}`);
                    if (el1) el1.classList.add('compare');
                    if (el2) el2.classList.add('compare');
                }

                // Ordenados (los primeros i elementos)
                for (let k = 0; k < this.i; k++) {
                    const el = document.getElementById(`element-${k}`);
                    if (el) el.classList.add('sorted');
                }
            }

            guardarEstadoActual() {
                const estado = {
                    currentStep: this.currentStep,
                    array: [...this.array],
                    i: this.i,
                    j: this.j,
                    key: this.key,
                    currentLine: this.currentLine
                };
                this.stepsHistory[this.currentStep] = {...estado};
            }

            restaurarEstadoAnterior() {
                if (this.currentStep < this.stepsHistory.length && this.stepsHistory[this.currentStep]) {
                    const estado = this.stepsHistory[this.currentStep];
                    this.array = [...estado.array];
                    this.i = estado.i;
                    this.j = estado.j;
                    this.key = estado.key;
                    this.currentLine = estado.currentLine;

                    this.resetAll();
                    if (this.currentLine && this.codeLines[this.currentLine]) {
                        this.codeLines[this.currentLine].classList.add('highlight');
                    }

                    this.actualizarVisualizacionArray();
                    this.actualizarIndicadoresArray();
                }
            }

            async resaltarLinea(lineId, mensaje) {
                this.resetAll();
                if (lineId && this.codeLines[lineId]) {
                    this.codeLines[lineId].classList.add('highlight');
                    this.currentLine = lineId;
                }
                this.pasoEl.textContent = mensaje;
                this.actualizarVisualizacionArray();
                this.actualizarIndicadoresArray();
                await this.sleep(600);
            }

            async siguientePaso() {
                if (this.isRunning) return;
                this.isRunning = true;

                this.guardarEstadoActual();
                this.currentStep++;

                if (this.currentStep === 1) {
                    await this.resaltarLinea('line-main-method', "Iniciando el m√©todo insertionSort");
                    await this.resaltarLinea('line-outer-loop', "Iterando sobre cada elemento desde el √≠ndice 1");
                }

                // Si ya terminamos
                if (this.i >= this.array.length) {
                    this.terminarSimulacion();
                    this.isRunning = false;
                    return;
                }

                // Guardar el valor actual a insertar
                this.key = this.array[this.i];
                await this.resaltarLinea('line-key', `key = arr[${this.i}] = ${this.key}`);

                // Inicializar j
                this.j = this.i - 1;
                await this.resaltarLinea('line-j', `j = ${this.j} (√≠ndice del elemento anterior)`);

                // Bucle interno: mover elementos mayores hacia la derecha
                while (this.j >= 0 && this.array[this.j] > this.key) {
                    await this.resaltarLinea('line-inner-loop-start', `¬øarr[${this.j}] > key (${this.key})?`);
                    await this.resaltarLinea('line-shift', `Desplazando arr[${this.j}] = ${this.array[this.j]} a la derecha`);
                    this.array[this.j + 1] = this.array[this.j];
                    this.actualizarVisualizacionArray();
                    this.actualizarIndicadoresArray();
                    await this.sleep(400);
                    this.j--;
                }

                // Insertar el valor en su posici√≥n correcta
                await this.resaltarLinea('line-insert', `Insertando key = ${this.key} en arr[${this.j + 1}]`);
                this.array[this.j + 1] = this.key;
                this.actualizarVisualizacionArray();
                this.actualizarIndicadoresArray();

                // Avanzar al siguiente elemento
                this.i++;
                this.isRunning = false;
                this.updateUI();
            }

            async pasoAnterior() {
                if (this.currentStep > 0) {
                    this.currentStep--;
                    this.restaurarEstadoAnterior();
                    this.updateUI();
                }
            }

            terminarSimulacion() {
                this.resetAll();
                this.stepExplanation.innerHTML = "‚úÖ ¬°Ordenamiento completado!<br><br>El array est√° completamente ordenado. El algoritmo de inserci√≥n ha terminado.";
                this.pasoEl.textContent = "Ordenamiento completado.";
                this.resultMessage.textContent = "El array ha sido ordenado exitosamente.";
                this.resultBox.className = "result-box";
                this.btnSiguiente.disabled = true;
                this.updateUI();
            }

            sleep(ms) {
                return new Promise(resolve => setTimeout(resolve, ms));
            }

            updateUI() {
                this.btnAnterior.disabled = this.currentStep <= 0;
                this.btnSiguiente.disabled = this.i >= this.array.length;

                let totalPasos = this.array.length - 1;
                let pasosActuales = this.i - 1;
                let progress = totalPasos > 0 ? (pasosActuales / totalPasos) * 100 : 0;
                this.pasoProgress.style.width = `${Math.min(progress, 100)}%`;
            }
        }

        document.addEventListener('DOMContentLoaded', function() {
            new InsertionSortSimulator();
        });
    </script>
</body>
</html>